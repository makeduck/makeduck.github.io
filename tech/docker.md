## 설치
boot2docker vs dockertoolbox
도커도 진행형. 리눅스에서는 바로 설치가능. 윈도우나iox vm별도 설치필요.. boot2docker 많이 쓴듯하나 150812 dockertoolbox 나옴. 요거 쓰는게 권장같음. https://blog.docker.com/2015/08/docker-toolbox/
요기 순서대로 설치 http://docs.docker.com/mac/step_one/


## 주요명령어

```
docker quickstart terminal 수행
docker images

docker ps

docker run -it ubuntu bash

파일생성&저장

docker diff [컨테이너아이디]

docker commit [컨테이너아이디]  centos:django

docker rmi -f [이미지아이디]

docker tag [이미지아이디] [저장소:태그]


docker push  [저장소:태그]

```

## 사용 예

mysql
docker run --name dubu-mysql -p 3306:3306 -e MYSQL_ROOT_PASSWORD=dubu  -d mysql:5.7

link
docker run --name dubu-app --link dubu-mysql:mysql -d mysql:5.7

msyql client
docker run -it --link dubu-mysql:mysql --rm mysql:5.7 sh -c 'exec mysql -h0c3a06b0115b -P3306 -uroot -pdubu'


도커 centos + mysql 연동

service 가 없을때

sudo yum install iperf3


yum install vim
yum install


docker pull centos
docker tag centos centos:django

cat /etc/redhat-release

docker run -it centos:django

cat /etc/redhat-release

도커 안에서 도커 이미 만드는 거는 비추.
centos7 에서 부터 시작하자


$  sudo yum install http://dl.fedoraproject.org/pub/epel/7/x86_64/e/epel-release-7-2.noarch.rpm
$  sudo yum install python-pip python-devel gcc

pip 가 설치 안됨

curl "https://bootstrap.pypa.io/get-pip.py" -o "get-pip.py"
python get-pip.py

 yum install mysql mysql-devel
  pip install django MySQL-python

$ sudo yum install mysql mysql-devel
$ sudo pip install django MySQL-python

장고 프로젝트 생성
django-admin.py startproject exampleapp

setting.py 수정

```
"""
Django settings for exampleapp project.

Generated by 'django-admin startproject' using Django 1.8.5.

For more information on this file, see
https://docs.djangoproject.com/en/1.8/topics/settings/

For the full list of settings and their values, see
https://docs.djangoproject.com/en/1.8/ref/settings/
"""

# Build paths inside the project like this: os.path.join(BASE_DIR, ...)
import os

BASE_DIR = os.path.dirname(os.path.dirname(os.path.abspath(__file__)))


# Quick-start development settings - unsuitable for production
# See https://docs.djangoproject.com/en/1.8/howto/deployment/checklist/

# SECURITY WARNING: keep the secret key used in production secret!
SECRET_KEY = '1l(9a*=)02fbv$=pbvc+r*%xvwf&d8)r89p=ff)x8#1st-0wu9'

# SECURITY WARNING: don't run with debug turned on in production!
DEBUG = True

ALLOWED_HOSTS = []


# Application definition

INSTALLED_APPS = (
    'django.contrib.admin',
    'django.contrib.auth',
    'django.contrib.contenttypes',
    'django.contrib.sessions',
    'django.contrib.messages',
    'django.contrib.staticfiles',
)

MIDDLEWARE_CLASSES = (
    'django.contrib.sessions.middleware.SessionMiddleware',
    'django.middleware.common.CommonMiddleware',
    'django.middleware.csrf.CsrfViewMiddleware',
    'django.contrib.auth.middleware.AuthenticationMiddleware',
    'django.contrib.auth.middleware.SessionAuthenticationMiddleware',
    'django.contrib.messages.middleware.MessageMiddleware',
    'django.middleware.clickjacking.XFrameOptionsMiddleware',
    'django.middleware.security.SecurityMiddleware',
)

ROOT_URLCONF = 'exampleapp.urls'

TEMPLATES = [
    {
        'BACKEND': 'django.template.backends.django.DjangoTemplates',
        'DIRS': [],
        'APP_DIRS': True,
        'OPTIONS': {
            'context_processors': [
                'django.template.context_processors.debug',
                'django.template.context_processors.request',
                'django.contrib.auth.context_processors.auth',
                'django.contrib.messages.context_processors.messages',
            ],
        },
    },
]

WSGI_APPLICATION = 'exampleapp.wsgi.application'


# Database
# https://docs.djangoproject.com/en/1.8/ref/settings/#databases


DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.mysql',
        'NAME': 'exampleapp',
        'USER': 'root',
        'PASSWORD': os.getenv('DB_ENV_MYSQL_ROOT_PASSWORD'),
        'HOST': os.getenv('MYSQL_HOST') or 'db',
        'PORT': '3306',
    }
}

# Internationalization
# https://docs.djangoproject.com/en/1.8/topics/i18n/

LANGUAGE_CODE = 'en-us'

TIME_ZONE = 'UTC'

USE_I18N = True

USE_L10N = True

USE_TZ = True


# Static files (CSS, JavaScript, Images)
# https://docs.djangoproject.com/en/1.8/howto/static-files/

STATIC_URL = '/static/'


```

Dockerfile

```
FROM centos:centos7

RUN yum install -y http://dl.fedoraproject.org/pub/epel/7/x86_64/e/epel-release-7-2.noarch.rpm
RUN yum install -y python-pip python-devel nginx gcc

RUN echo "daemon off;" >> /etc/nginx/nginx.conf
ADD exampleapp.conf /etc/nginx/conf.d/exampleapp.conf

RUN yum install -y python-pip python-devel nginx gcc mysql-devel
RUN pip install django gunicorn MySQL-python

ADD ./ /var/www/exampleapp
WORKDIR /var/www/exampleapp
RUN chmod +x entrypoint.sh
RUN rm -rf *.rpm

EXPOSE 80

ENTRYPOINT ./entrypoint.sh


```


exampleapp.conf

```
upstream gunicorn {
  server unix:/tmp/gunicorn.sock;
}

server {
  listen 80;
  server_name _;

  location /static/ {
    alias /var/www/exampleapp/static/;
  }

  location / {
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header Host $http_host;
    proxy_redirect off;

    if (!-f $request_filename) {
      proxy_pass http://gunicorn;
      break;
    }
  }
}
```

entry point 도 만

이미지 생
docker build --tag django .


sudo yum install docker-engine
yum install docker

sudo service docker start   // 도커안에서 서비스 실행은 안된다

~/exampleapp$ sudo docker build --tag django .

dockeer 안에서 docker 실행


git clone https://github.com/pyrasis/dind.git
